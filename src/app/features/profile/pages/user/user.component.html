<app-hero></app-hero>

<div class="profile-container">
  <div class="profile-header">
    <h1>User Profile</h1>
    <div class="quote-container">
      <i class="pi pi-comment"></i>
      <p>
        "Wubba Lubba Dub Dub! Nobody exists on purpose. Nobody belongs anywhere.
        We're all going to die. Come update your profile."
      </p>
      <span>- Rick Sanchez</span>
    </div>
  </div>

  <div class="profile-section">
    <h2>Profile Information</h2>
    <div class="profile-card" *ngIf="!editMode">
      <div class="profile-info">
        <div class="info-row">
          <span class="label">Name:</span>
          <span class="value">{{ userData.name }}</span>
        </div>
        <div class="info-row">
          <span class="label">Surname:</span>
          <span class="value">{{ userData.surname }}</span>
        </div>
        <div class="info-row">
          <span class="label">Email:</span>
          <span class="value">{{ userData.email }}</span>
        </div>
      </div>
      <div class="profile-actions">
        <button
          pButton
          type="button"
          label="Edit Profile"
          icon="pi pi-pencil"
          class="p-button-outlined"
          (click)="toggleEditMode()"
        ></button>
      </div>
    </div>

    <div class="profile-card" *ngIf="editMode">
      <form [formGroup]="profileForm" (ngSubmit)="updateProfile()">
        <div class="form-group">
          <label for="name">Name</label>
          <input id="name" type="text" pInputText formControlName="name" />
          <small
            *ngIf="
              profileForm.get('name')?.invalid &&
              profileForm.get('name')?.touched
            "
            class="p-error"
            >Name is required</small
          >
        </div>

        <div class="form-group">
          <label for="surname">Surname</label>
          <input
            id="surname"
            type="text"
            pInputText
            formControlName="surname"
          />
          <small
            *ngIf="
              profileForm.get('surname')?.invalid &&
              profileForm.get('surname')?.touched
            "
            class="p-error"
            >Surname is required</small
          >
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" type="email" pInputText formControlName="email" />
          <small
            *ngIf="
              profileForm.get('email')?.invalid &&
              profileForm.get('email')?.touched
            "
            class="p-error"
          >
            Valid email is required
          </small>
        </div>

        <div class="form-actions">
          <button
            pButton
            type="button"
            label="Cancel"
            icon="pi pi-times"
            class="p-button-outlined p-button-secondary"
            (click)="cancelEdit()"
          ></button>
          <button
            pButton
            type="submit"
            label="Save Changes"
            icon="pi pi-check"
            [disabled]="profileForm.invalid || loading"
          ></button>
        </div>
      </form>
    </div>
  </div>

  <div class="profile-section">
    <h2>Change Password</h2>
    <div class="profile-card">
      <form [formGroup]="passwordForm" (ngSubmit)="updatePassword()">
        <div class="form-group">
          <label for="currentPassword">Current Password</label>
          <p-password
            id="currentPassword"
            formControlName="currentPassword"
            [toggleMask]="true"
            [feedback]="false"
          ></p-password>
          <small
            *ngIf="
              passwordForm.get('currentPassword')?.invalid &&
              passwordForm.get('currentPassword')?.touched
            "
            class="p-error"
            >Current password is required</small
          >
        </div>

        <div class="form-group">
          <label for="newPassword">New Password</label>
          <p-password
            id="newPassword"
            formControlName="newPassword"
            [toggleMask]="true"
          ></p-password>
          <small
            *ngIf="
              passwordForm.get('newPassword')?.invalid &&
              passwordForm.get('newPassword')?.touched
            "
            class="p-error"
          >
            New password is required (min 6 characters)
          </small>
        </div>

        <div class="form-group">
          <label for="confirmNewPassword">Confirm New Password</label>
          <p-password
            id="confirmNewPassword"
            formControlName="confirmNewPassword"
            [toggleMask]="true"
            [feedback]="false"
          ></p-password>
          <small
            *ngIf="
              passwordForm.get('confirmNewPassword')?.invalid &&
              passwordForm.get('confirmNewPassword')?.touched
            "
            class="p-error"
          >
            Confirmation is required
          </small>
          <small
            *ngIf="
              passwordForm.hasError('passwordMismatch') &&
              passwordForm.get('confirmNewPassword')?.touched
            "
            class="p-error"
          >
            Passwords do not match
          </small>
        </div>

        <div class="form-actions">
          <button
            pButton
            type="submit"
            label="Update Password"
            [disabled]="passwordForm.invalid || loading"
          ></button>
        </div>
      </form>
    </div>
  </div>

  <div class="profile-section danger-zone">
    <h2>Danger Zone</h2>
    <div class="profile-card">
      <div class="danger-message">
        <i class="pi pi-exclamation-triangle"></i>
        <div>
          <h3>
            "You're like Hitler, but even Hitler cared about Germany or
            something!"
          </h3>
          <p>
            Deleting your account will permanently erase all your data from our
            system. This action cannot be undone, just like Rick can't undo his
            questionable life choices.
          </p>
        </div>
      </div>
      <button
        pButton
        type="button"
        label="Delete Account"
        icon="pi pi-trash"
        class="p-button-danger"
        (click)="confirmDelete()"
      ></button>
    </div>
  </div>
</div>

<p-confirmDialog
  header="Confirm Deletion"
  icon="pi pi-exclamation-triangle"
></p-confirmDialog>
